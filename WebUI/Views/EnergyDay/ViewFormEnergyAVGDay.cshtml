@using TReport.TRForms;
@using Measurement;
@using WebUI.App_LocalResources;

@model Form
<a href="#" id="avg-day" class="show-detali-object a-show-detali">@ReportEnergyResource.form_ed_caption</a>
<div class="status detali-object">
    <table class="table_blur" id="table-flow-energy-day">
        @*<caption>@ReportEnergyResource.form_ed_caption</caption>*@
        @foreach (Group groupitem in @Model.Groups.OrderBy(g => g.position))
        {
            foreach (TReport.TRForms.Type typeitem in groupitem.Types.OrderBy(t => t.position))
            {
                <tr>
                    <th rowspan="2">@ReportEnergyResource.form_efd_field_name</th>
                    @foreach (ItemObject io in typeitem.Items[0].ItemObjects.OrderBy(o => o.trobj))
                    {
                        <th colspan="2">@io.Object</th>
                    }
                </tr>
                <tr>
                    @foreach (ItemObject io in typeitem.Items[0].ItemObjects.OrderBy(o => o.trobj))
                    {
                        <th>@ReportEnergyResource.form_efd_field_value</th>
                        <th>@ReportEnergyResource.form_efd_field_unit</th>
                    }
                </tr>
                <tr><th colspan='@( (@typeitem.Items[0].ItemObjects.Count()*2)+1)'>@groupitem.name.ToUpper()</th></tr>
                foreach (Item ei in typeitem.Items.OrderBy(i => i.position))
                {
                    <tr>
                        <th>@ei.name</th>
                        @foreach (ItemObject io in ei.ItemObjects.OrderBy(o => o.trobj))
                        {
                            <td class="value">
                                @if (io.ItemValues[0].Values[0].value != null)
                                {
                                    @( ((DBValueMeasurement)io.ItemValues[0].Values[0].value).GetValue("n3"))
                                }
                            </td>
                            <td class="unit">
                                @if (io.ItemValues[0].Values[0].value != null)
                                {
                                    @( ((DBValueMeasurement)io.ItemValues[0].Values[0].value).GetUnitMultiplier())
                                }
                            </td>

                        }
                    </tr>

                }
            }
        }
    </table>
</div>